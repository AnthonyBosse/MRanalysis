if 0


%%%% circulation pattern
close all
axes('position',[.1 .1 .8 .6],'fontsize',8)
hold on
contourf(lg_bat,lt_bat,z,[-4000:250:0],'linestyle','none')

[c,h]=contour(lg_bat,lt_bat,z,[-4000:500:-500],'color',[.5 .5 .5],'linewidth',.1);
clabel(c,h,'fontsize',5,'color',[.5 .5 .5],'labespacing',300)

colormap(cm)
caxis([-10000 10000]/1)
lat_lon_proportions
plot(lg_edd1,lt_edd1,'-k','linewidth',2)
plot_triangle(lg_edd1,lt_edd1,0.4)
plot(lg_edd2,lt_edd2,'-k','linewidth',2)
plot_triangle(lg_edd2,lt_edd2,0.4)
plot(lg_meander,lt_meander,'-k','linewidth',2)
plot_triangle(lg_meander,lt_meander,0.4)
plot(lg_arr,lt_arr,'-k','linewidth',1)
plot_triangle(lg_arr,lt_arr,0.2)

[x y] = ginput(6);


end


lg_recirc = [
    5.4166
    2.8578
    0.5123
   -0.4117
];
lt_recirc = [
   78.7685
   79.4803
   79.3379
   78.7922
];

lg_JMC = [
  -16.2619
  -14.9825
  -13.2056
  -11.6419
   -8.8699
   -5.6714
];
lt_JMC = [
   72.8133
   72.2676
   71.8642
   71.6270
   71.2236
   71.5795
];

lg_outfl = [
    9.9424
    9.4564
    9.0399
    8.5539
    8.3456
    8.1374
    8.3456
    8.2762
    7.9985
    7.7208
];
lt_outfl = [
   77.6377
   78.0316
   78.3097
   78.6573
   78.8427
   79.0049
   79.1903
   79.3989
   79.5148
   79.7465
];

lg_outfl2 = [
   13.6913
   13.8301
   12.5805
   11.7474
   10.2895
    9.3870
]+2;
lt_outfl2 = [
   74.4164
   75.0190
   75.7374
   76.4094
   77.1278
   77.5450
]-0.5;

lg_outfl3 = [
    8.2762
    7.7903
    7.5820
    7.9985
    8.0680
    8.0680
];
lt_outfl3 = [
   74.9031
   75.5520
   76.4326
   77.1278
   77.7072
]-0.5;

lg_bso = [
   16.6765
   16.3294
   16.8154
   17.5096
   18.2039
];lg_bso = lg_bso+0.3;
lt_bso = [
   70.4768
   71.0562
   71.4965
   71.6587
   71.7514
];

lg_bso2 = [
   14.8715
   14.5938
   14.8021
   15.6352
   16.7460
   17.6485
]+1.2;
lt_bso2 = [
   71.4501
   71.8441
   72.0527
   72.2844
   72.4698
   72.5857
];

lg_infl1 = [
   -8.3855
   -7.3442
   -6.4417
   -4.5672
   -3.0399
   -2.0680
   -1.4431
   -0.6100
    0.2230
    0.9173
];
lt_infl1 = [
   62.7135
   62.8757
   63.0147
   62.8757
   62.9452
   63.0379
   63.2233
   63.4087
   63.5477
   63.7795
];

lg_infl2 = [   
   -3.1787
   -2.4845
   -1.4431
   -0.1935
    1.4727
];
lt_infl2 = [
   61.1840
   61.6011
   62.2268
   62.5744
   62.9916
];


lg_meander = [
    9.9014
   10.1581
   10.0811
    9.7731
    9.7731
   10.0811
   10.6715
   11.1335
%   11.1335
%   10.6715
]-0.3;
lt_meander = [
   68.0324
   68.1781
   68.3666
   68.4951
   68.6493
   68.7607
   68.7607
   68.7007
%   68.5636
%   68.4180
]-0.1;

lg_edd1 = [
%   11.3131
   11.7495
   12.3655
   12.3142
   12.0318
   11.5185
   11.3131
   11.3131
%   11.4158
%   11.4928
]-0.2;
lt_edd1 = [
%   68.6922
   68.7007
   68.8293
   68.9749
   69.1206
   69.1034
   68.9578
   68.8293
%   68.7950
%   68.7350
];

lg_edd1 = lg_edd1;lt_edd2 = lt_edd1;

lg_edd2 = fliplr(lg_edd1)+2;lt_edd2 = fliplr(lt_edd1)+0.5;
tmp_lg = nanmean(lg_edd2);tmp_lt = nanmean(lt_edd2);
lg_edd2 = lg_edd2-tmp_lg;lt_edd2 = lt_edd2-tmp_lt;
lg_edd2 = lg_edd2*(1.25)+tmp_lg;lt_edd2 = lt_edd2*1.25+tmp_lt;

lg_edd2 = [
   13.0585
   12.5708
   12.1345
   12.1345
   12.3655
   12.9045
   13.5719
   13.8799
   13.8285
   13.7259
];
lt_edd2 = [
   69.1206
   69.0520
   69.1463
   69.3690
   69.4976
   69.6089
   69.5490
   69.4633
   69.3433
   69.2748
];
lg_edd3  =[
   10.3378
   10.0811
    9.6704
    9.4138
    9.4138
    9.5421
    9.9014
   10.3891
   10.4404
   10.5431
];
lt_edd3 = [
   69.8831
   69.8146
   69.7974
   69.8917
   70.0545
   70.2001
   70.2858
   70.2772
   70.1916
   70.0031
];

lg_arr = [
   12.9045
   12.5965
   11.8008
   11.5185
];
lt_arr = [
   69.7974
   69.9517
   70.0802
   70.0887
];

lg_VP = [
    1.6805
    1.6385
    2.2536
    2.9386
    4.0290
    5.5946
    6.5452
    7.5237
    8.2366
    9.2571
];
lt_VP = [
   67.0043
   67.4755
   67.8953
   68.2295
   68.2295
   68.1781
   68.1353
   67.8182
   67.7840
   67.9810
];

lg_slope = [
    8.0277
    8.9774
   10.7741
   13.0328
   15.6509
   16.8829
   16.3953
   14.6242
   13.9825
   14.8809
];

lt_slope = [
   67.0471
   67.6554
   68.2980
   68.9492
   69.5147
   70.3372
   71.4425
   72.2564
   72.9076
   73.7472
];

lg_deep = [
    1.7906
    3.8439
    6.4877
    7.8224
    7.1294
    6.1283
    2.8686
   -0.4938
   -2.0082
   -1.0842
];

lt_deep = [
   68.9920
   68.7436
   68.8550
   69.2748
   70.3800
   71.3225
   71.7509
   71.1940
   70.3286
   69.7546
];
lg_west = [
    1.3799
    1.4055
   -0.2885
   -2.3932
   -3.4969
   -4.4979
   -4.4979
   -3.7023
   -2.9579
   -2.6499
];
lt_west = [
   67.1157
   67.7925
   68.6408
   69.4033
   70.1230
   70.5942
   71.0055
   71.4253
   71.6395
   71.7252
];
lg_MR = [
   -1.9312
   -1.2895
   -0.1858
    0.8409
    2.7146
    4.0493
    5.6407
    7.0780
    8.3101
    8.9517
];
lt_MR = [
   71.7938
   71.8966
   72.0337
   72.2393
   72.4535
   72.6506
   72.9676
   73.1903
   73.3960
   73.8672
];
lg_MR2 = [
   -2.0595
   -1.4435
    1.5339
    1.6109
    4.5626
    4.6910
    7.4117
    8.2844
    8.2844
    8.2844
];
lt_MR2 = [
   71.8537
   72.3764
   72.0679
   72.7619
   72.5563
   73.4217
   73.3017
   73.8329
   73.9015
   73.9614
];
lg_LBE = [
    2.8686
    2.1499
    2.1499
    2.3552
    3.0739
    3.6386
    4.2033
    4.1520
    3.9979
    3.3049
];lg_LBE = (lg_LBE-nanmean(lg_LBE))*0.75 + nanmean(lg_LBE);
lt_LBE = [
   69.9602
   70.1059
   70.3372
   70.5514
   70.6799
   70.6285
   70.3886
   70.1916
   69.9859
   69.9859
];lt_LBE = (lt_LBE-nanmean(lt_LBE))*0.75 + nanmean(lt_LBE);

lg_nor = [
   -4.1871
   -6.0324
   -8.2662
   -7.8777
   -7.3921
   -7.3921
];
lt_nor = [
   70.2893
   71.0025
   70.6459
   69.2518
   67.5984
   67.1121
];
lg_svin1 = [
    4.9439
    5.1521
    5.1521
    5.7075
    6.1935
    6.7489
];
lt_svin1 = [
   63.7563
   64.4284
   65.3322
   65.9115
   66.3286
   66.5604
];
lg_svin2 = [
    2.4446
    3.0000
    2.3752
    1.8892
    1.7504
    1.6115
];
lt_svin2 = [
   64.4979
   65.0309
   65.7956
   66.0042
   66.2823
   66.4213
];

lg_egc = [
   -4.4978
   -4.1507
   -4.3589
   -6.4417
  -11.3013
  -15.6751
];
lt_egc = [
   79.8392
   78.4951
   77.4291
   76.3631
   75.0885
   73.5358
];
%%%%%%%%
for varr = {'egc','VP','MR','west','slope','deep','MR2','LBE','edd1','edd2','edd3','meander','arr','infl1','infl2','bso','nor','bso2','svin1','svin2','outfl2','outfl3','JMC','recirc'}
eval(['lg_' varr{1} ' = mean_av(interp1(1:length(lg_' varr{1} '),lg_' varr{1} ',linspace(1,length(lg_' varr{1} '),100)),10);'])
eval(['lt_' varr{1} ' = mean_av(interp1(1:length(lt_' varr{1} '),lt_' varr{1} ',linspace(1,length(lt_' varr{1} '),100)),10);'])
end

